S32K3xx_AMMCLIB_1.1.34
=======================
Revision 1.1.34
30-September-2023

RELEASE NOTES
=============
This is the NXP Service Release for rev 1.1.34 of the Automotive Math and Motor Control Library Set for NXP S32K3xx (S32K311, S32K312, S32K314, S32K322, S32K324, S32K328, S32K338, S32K341, S32K342, S32K344, S32K348, S32K358, S32K374, S32K376, S32K394, S32K396), MWCT2DxxS, and MWCT20xxS devices, supporting the ARM M7 core.
Note: MWCT part numbers contain NXP confidential IP for Qi Wireless Power.

Installation instructions:
==========================
Run S32K3xx_AMMCLIB_RTM_1_1_34.exe self executable file, in order to start the installation procedure and follow the instruction on the screen. The recommended destination path (the default one) is: C:\NXP\AMMCLIB\S32K3xx_AMMCLIB_1.1.34

Important notes:
================
As the Automotive Math and Motor Control Library Set for NXP S32K3xx devices supports the global configuration option, it is recommended to copy the SWLIBS_Config.h file to your local structure and refer the configuration to this local copy. This approach will prevent incorrect setup of default configuration option if multiple projects with different default configuration are used.

The Automotive Math and Motor Control Library Set for NXP S32K3xx devices is delivered with pre-selected default configuration option in the SWLIBS_Config.h file. The user can change the default configuration option according to the application need.

To get correct results from macros FRAC32(x) and FRAC16(x), the compiler must support double precision floating-point constants. Make sure to set the compiler options according to the chapter "Pre-compiled library compilation options".

The bit-accurate models contain sources auto-generated by MATLAB(r). (c) 1984 - 2019 The MathWorks, Inc.

Known limitations and issues:
=============================
- S32 Design Studio 3.4 project with IAR compiler and AMMCLib used as a plugin for the RTD fails to compile due to a bug in the S32 Configuration Tool (incorrect name of linked library).
- S32 Design Studio 3.5 project with IAR compiler and AMMCLib used as a plugin for RTD 4.4 2.0.3 D2302 fails to compile for the S32K322 derivative due to a bug in the linker file provided by RTD.

The library was built and tested using the following compilers:
===============================================================
- Green Hills MULTI v2021.1.4
- IAR ANSI C/C++ Compiler for ARM 8.50.10.290
- S32 Design Studio for S32 Platform, IDE version 3.5, compiler version 10.2.0 20200723

Note: Recommended compiler options are specified at the end of this document.

What's new in 1.1.34:
====================
- (MCL-2041) Lowered the required installer privileges to avoid UAC screen.
- (MCL-2007) Changed the static local variables to global in the code generated by Simulink. Removed redundant declarations.

Release history:
================
Rev 1.1.33
- (MCL-1879) Updated proprietary disclaimer.
- (MCL-1624) Improved formatting of multiple equations in User's Guide.
- (MCL-1614) Added improved FOC schematic to all FOC related functions in User's Guide.
- (MCL-1855) Added support for S32K3_RTD_4.4_R21-11_3.0.0_D2303.

Rev 1.1.32
- (MCL-1487) Added function AMCLIB_EstimBJ for offline parameter estimation.
- (MCL-1569) Added description of known limitations when compiling AMMCLib using IAR compiler in S32 Design Studio with RTD.
- (MCL-1602) Improved accuracy and performance of GMCLIB_SvmStd_FLT.
- (MCL-1592) Improved accuracy of GMCLIB_DoubleSwitching function.
- (MCL-1601) Clarified the indexes in the equation AMCLIB_BemfObsrvDQ_Eq2.
- (MCL-1582) Added description of limitations for the input fltPosOut of AMCLIB_TrackObsrvSetState_FLT.
- (MCL-1593) The new supported S32K3 RTD version in the S32 Design Studio is SW32K3 RTD 4.4 2.0.3 D2302.

Rev 1.1.31
- (MCL-1556) Fixed formatting issues in User's Guide.

Rev 1.1.30
- (MCL-1471) Added support for S32K3 RTD v2.0.1.
- (MCL-1350) AMMCLib update sites now place the SCR files in the S32DS SCR folder.
- (MCL-1482) Added support for S32 Design Studio version 3.5.
- (MCL-1468) Corrected wrong state variable and disconnected limit flag output in BAM of AMCLIB_FWSpeedLoop and AMCLIB_SpeedLoop.
- (MCL-1467) Corrected issues with compilation of AMCLIB_FWSpeedLoop BAM for simulation in rapid accelerator mode.
- (MCL-1357) Improved documentation of AMCLIB_FluxEstimAB
- (MCL-1481) Corrected documentation of MLIB_ConvertPU_F32F16 and MLIB_ConvertPU_F16F32.
- (MCL-1351) Improved documentation of S32DS integration.
- (MCL-1458) Improved formatting of equations in documentation.

Rev 1.1.29
- (MCL-1308) Added support for Matlab R2019a, R2019b, R2020a, R2020b, R2021a, R2021b, R2022a.
- (MCL-1417) Updated GMCLIB_DoubleSwitching documentation.
- (MCL-1411) BAMs refer to root-level Simulink schematic when accessing data dictionary from subsystems.
- (MCL-1393) Renamed macro ASM to SWLIBS_ASM to improve compatibility with platform header files.
- (MCL-1403) Added protection against destructive optimizations due to signed integer overflow in MLIB_Add and MLIB_Sub.

Rev 1.1.28
- (MCL-1389) Corrected documentation of the API of GFLIB_VectorLimit.
- (MCL-1368) Updated documentation of reentrancy.

Rev 1.1.27
- (MCL-1337) Fix equations in User's Guide in  GFLIB_ControllerPIDpAW function.
- (MCL-1343) Added output UpperLimit to BAM blocks of functions AMCLIB_CurrentLoop and AMCLIB_CurrentLoopPIp.
- (MCL-1349) Added selectable ramp state output to BAM block AMCLIB_FWSpeedLoop and AMCLIB_SpeedLoop. Corrected debugging outputs in generated code for AMCLIB_FWSpeedLoop and AMCLIB_SpeedLoop.
- (MCL-1159) Enhanced BAM intefraces to simplify calculation of Simulink block parameters.
- (MCL-1170) Added function AMMCLIB_FluxEstimAB (Rotor Flux Estimator in Alpha-Beta Reference Frame).

Rev 1.1.26
- (MCL-1307) Changed the Green Hills compiler version for S32K3xx to 2021.1.4.
- (MCL-1305) Changed S32DS/GCC compiler version to 10.2 for S32K3 platform.
- (MCL-1306) Changed IAR compiler version to 8.50.10 for S32K3 platform.
- (MCL-1311) Added new function MLIB_DivSatAccurate_F32 for fixed-point saturated division with full 32-bit accuracy of results.
- (MCL-1255) Added function AMCLIB_CurrentLoopPIp

Rev 1.1.25
- (MCL-1272) Added new function GMCLIB_SpreadPWM for spreading spectrum of PWM to improve EMC.
- (MCL-1279) Corrected parameter cast in TLC files for Simulink bit accurate models to enable code generation in newer versions of Matlab.
- (MCL-1153) Improved documentation of fixed-point controllers and integrator.
- (MCL-1299) Specified SDK category in S32DS update site.
- (MCL-1313) Fixed documentation of GMCLIB_DoubleSwitching
- (MCL-1267) Simulink BAM data types were moved from the file SWLIBS_Typedefs.mat to the data dictionary file ammclib_types.sldd.
- (MCL-1266) Corrected assignment of output values in the documentation of AMCLIB_TrackObsrv.
- (MCL-1273) Added new function AMCLIB_EstimRL for offline estimation of PMSM electrical parameters.

Rev 1.1.24
- (MCL-1257) Improved documentation of GFLIB_Lut1D and GFLIB_Lut2D.
- (MCL-1211) Added explicit type cast for matrix, vector, and struct elements in code generated from Simulink.
- (MCL-1263) Changed version of the S32 Design Studio to 3.4.
- (MCL-1226) Added function GMCLIB_SvmStd6Ph (Six-phase Space Vector Modulation)
- (MCL-1167) Added function GMCLIB_ClarkInv6Ph (Six-phase Inverse Clark Transform)

Rev 1.1.23
- (MCL-1211) Added explicit type cast for matrix, vector, and struct elements in code generated from Simulink.
- (MCL-1208) Added missing macros in vector functions.
- (MCL-1212) Fixed trigger calculation in GMCLIB_DoubleSwitching function.
- (MCL-1112) Added function GMCLIB_Clark6Ph (direct six-phase Clark transform).

Rev 1.1.22
- (MCL-1019) Initial release for S32K3xx.
- (MCL-1154) Added pragma to ensure correct inlining with IAR compiler. Changed the supported IAR compiler version to 8.40.3.
- (MCL-1163) Added AMMCLIB in Simulink library browser.


Pre-compiled library compilation options:
=========================================
The Automotive Math and Motor Control Library Set for NXP S32K3xx devices is delivered with pre-compiled libraries for all supported compilers. The following options were used to build these libraries:
S32 Design Studio for S32 Platform, GCC compiler version 10.2.0 20200723
    -mcpu=cortex-m7 \
    -mfloat-abi=hard -mfpu=fpv5-sp-d16 \
    -std=c99 \
    -mthumb \
    -O3 \
    -c \
    -ffunction-sections \
    -fmessage-length=0
    NOTE: NewLib must be selected as standard library

Green Hills MULTI v2021.1.4
    -cpu=cortexm7 \
    -fpu=vfpv5_d16 \
    -fsingle \
    -O3 -Otime \
    -c99 \
    -preprocess_assembly_files \
    --no_exceptions \
    -Wundef \
    -Wimplicit-int \
    -Wshadow \
    -Wtrigraphs \
    --no_commons \
    --gnu_asm

IAR ANSI C/C++ Compiler for ARM 8.50.10.290
    --endian=little --cpu=Cortex-M7 -e --fpu=VFPv5-SP \
    -Ohs --use_c++_inline --silent \
    --thumb \
    --dlib_config <IAR install dir>/arm/INC/c/DLib_Config_Normal.h
